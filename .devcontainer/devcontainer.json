{
    "name": "PMSM Project Dev Container",
    // Tells VS Code how to build the container image
    "build": {
        "dockerfile": "Dockerfile",
        "context": ".." // The context is the project root, one level up from .devcontainer
    },
    // These commands run ONCE after the container is created for the first time.
    // This is where we create the venv and install dependencies into it.
    "postCreateCommand": "python3 -m venv .venv && .venv/bin/pip install -r requirements.txt",
    // VS Code customizations for this container
    "customizations": {
        "vscode": {
            // Automatically install these extensions inside the container
            "extensions": [
                "ms-python.python", // Core Python support
                "ms-python.vscode-pylance", // Smart code completion
                "charliermarsh.ruff" // Modern, fast linter and formatter
            ],
            // Automatically apply these settings when you open the project in the container
            "settings": {
                // --- THIS IS THE KEY PART ---
                // Tell VS Code's Python extension to automatically find and use our venv
                "python.defaultInterpreterPath": "${containerWorkspaceFolder}/.venv/bin/python",
                // Optional: Quality-of-life settings for a better Python experience
                "terminal.integrated.defaultProfile.linux": "bash",
                "[python]": {
                    "editor.formatOnSave": true,
                    "editor.defaultFormatter": "charliermarsh.ruff"
                }
            }
        }
    },
    // Run the container as the non-root 'vscode' user for better security
    "remoteUser": "vscode"
}